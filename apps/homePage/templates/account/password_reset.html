{% extends "account/base.html" %}
{% load i18n %}

{% block head_title %}{% trans "Password Reset" %}{% endblock %}

{% block content %}
<header class="panel-header auth-header">
    <p class="section-subtitle">{% trans "Reset your password" %}</p>
    <h1 class="section-title">{% trans "Forgot Password?" %}</h1>
    <p class="auth-description">{% trans "Enter your email address and we'll send you a link to reset your password." %}</p>
</header>

<form class="stack auth-form auth-form--no-scroll" method="post" action="{% url 'account_reset_password' %}" autocomplete="off">
    {% csrf_token %}
    {% if redirect_field_value %}
    <input type="hidden" name="{{ redirect_field_name }}" value="{{ redirect_field_value }}">
    {% endif %}
    
    {% for field in form.visible_fields %}
    <div class="form-group">
        <label class="form-label" for="{{ field.id_for_label }}">{{ field.label }}</label>
        {{ field }}
        {% if field.errors %}
            <p class="error">{{ field.errors|join:", " }}</p>
        {% endif %}
    </div>
    {% endfor %}

    {% if form.non_field_errors %}
    <div class="form-alert">
        {% for error in form.non_field_errors %}
            <p>{{ error }}</p>
        {% endfor %}
    </div>
    {% endif %}

    <div class="stack auth-actions">
        <button type="submit" class="btn btn-accent btn-full">{% trans "Send Reset Link" %}</button>
        <div class="auth-links auth-links--pill">
            <a class="back-link back-link--pill-text" href="{% url 'account_login' %}?force_clear=1{% if redirect_field_value %}&{{ redirect_field_name }}={{ redirect_field_value|urlencode }}{% endif %}">
                {% trans "Return to Sign in" %}
            </a>
        </div>
    </div>
</form>
{% if request.GET.force_clear %}
<script>
document.addEventListener('DOMContentLoaded', function() {
    const inputs = document.querySelectorAll('input[type="email"], input[type="text"], input[type="password"]');
    inputs.forEach((input) => {
        input.value = '';
        input.setAttribute('autocomplete', 'off');
        input.setAttribute('autocapitalize', 'none');
        input.setAttribute('autocorrect', 'off');
        if (input.type === 'password') {
            input.style.background = '#fff';
            input.style.color = '#222';
        }
    });
});
</script>
{% endif %}
{% endblock %}
